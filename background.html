<h2>Background</h2>

<script>
    const { ipcRenderer } = require('electron');
    require('reddit.js');

    ipcRenderer.on('sub', (event, args) => {
        var subs = args.subreddit.split(',');
        console.log(subs);
        var subreddit = subs[Math.floor(Math.random() * subs.length)];

        reddit
            .top(subreddit.trim())
            .t('all')
            .limit(1000)
            .fetch(res => {
                console.log(res.data.children);
                var image =
                    res.data.children[
                        Math.floor(Math.random() * res.data.children.length)
                    ];

                while (image.data.url.endsWith('.jpg') == false) {
                    console.log('While');
                    image =
                        res.data.children[
                            Math.floor(Math.random() * res.data.children.length)
                        ];
                }

                ipcRenderer.send('change-wallpaper', {
                    link: image.data.url,
                    scale: args.scale
                });
            });
    });
</script>
